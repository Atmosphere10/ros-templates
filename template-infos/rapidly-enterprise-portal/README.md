## **方案概览**

近年来，随着数字化转型的加速，企业对于快速开发和部署应用程序的需求日益增长。低代码开发平台因其高效、灵活的特点而受到广泛欢迎，其中魔笔（Mobi）作为一款先进的低代码开发工具，正逐渐成为众多开发者和企业的首选。

使用魔笔构建应用的主要优势包括：

1. **快速开发：**魔笔提供了一套丰富的组件库和直观的拖拽式界面设计工具，使开发者能够以极高的效率完成应用的构建，大大缩短了项目周期。
2. **易于学习和使用：**无论您是否拥有编程背景，都可以通过魔笔轻松上手，实现复杂业务逻辑的构建。这不仅降低了技术门槛，也为企业节省了培训成本。
3. **安全可靠：**依托于阿里云的安全保障体系，魔笔能够为用户提供稳定、安全的服务环境，保护数据隐私不受侵犯。

本文将详细为您介绍如何使用魔笔快速构建一个企业门户网站。

### **方案架构**

方案提供的默认设置完成部署后在阿里云上搭建的网站运行环境如下图所示。实际部署时您可以根据资源规划修改部分设置，但最终形成的运行环境与下图相似。

![低代码建站架构图.png](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/5835983371/p883121.png)

本方案的技术架构包括以下基础设施和云服务：

* 域名：一个已经完成备案的域名。
* 云解析 DNS：一组按照要求添加的DNS解析记录。
* 专有网络 VPC：一个专有网络，构建云上私有网络。
* 云数据库 RDS：一个云数据库 RDS MySQL 实例，为门户网站提供数据服务。
* 多端低代码开发平台魔笔：魔笔平台，提供一站式的应用创建和全生命周期管理。

## **方案部署**
### **部署准备**

开始部署前，请按以下指引完成账号申请、账号充值。

#### **准备账号**

1. 如果您还没有阿里云账号，请访问[阿里云账号注册页面](https://account.aliyun.com/register/qr_register.htm)，根据页面提示完成注册。阿里云账号是您使用云资源的付费实体，因此是部署方案的必要前提。
2. [为阿里云账号充值](https://help.aliyun.com/document_detail/324650.html)。本方案的云资源支持按量付费，且默认设置均采用按量付费引导操作。如果确定任何一个云资源采用按量付费方式部署，账户余额必须大于等于100元。

#### 开通魔笔空间

如果您是首次使用魔笔平台，请先单击[开通魔笔空间](https://mobinext.console.aliyun.com/)，进入页面后，无需任何操作即可完成试用版魔笔空间的开通。

**说明** 

试用版魔笔只能创建一个应用，如果想创建多个应用，需要删除原有的应用或升级[魔笔套餐](https://common-buy.aliyun.com/?commodityCode=miniappdev_Mobi2Pre_public_cn)。

### **一键部署**


一键部署基于阿里云资源编排服务ROS（Resource Orchestration Service）实现，模板是描述基础设施和架构的蓝图，通过ROS模板可自动化地完成云资源的创建和配置，提高资源的创建和部署效率。本方案提供的ROS模板完成资源的创建和配置内容包括：

* 专有网络 VPC：一个专有网络，构建云上私有网络。
* 云数据库 RDS：一个云数据库 RDS MySQL 实例，为门户网站提供数据服务。
* 多端低代码开发平台魔笔：魔笔平台，为网站提供一站式的应用全生命周期管理。

#### **操作步骤**

1. 打开[一键部署模板链接](https://ros.console.aliyun.com/cn-hangzhou/stacks/create?templateUrl=https://ros-public-templates.oss-cn-hangzhou.aliyuncs.com/service_template/technical-solution/build-enterprise-web-with-mobi.yml&hideStepRow=true&hideStackConfig=true&pageTitle=%E4%BD%8E%E4%BB%A3%E7%A0%81%E9%AB%98%E6%95%88%E6%9E%84%E5%BB%BA%E4%BC%81%E4%B8%9A%E9%97%A8%E6%88%B7%E7%BD%91%E7%AB%99&disableRollback=false&isSimplified=true&disabltion=true&productNavBar=disabled&balanceIntercept=true)前往ROS控制台，系统自动打开使用新资源创建资源栈的面板。
2. 在**配置参数**页面完成RDS配置后（本教程以华东1（杭州）为例），单击**下一步：检查并确认**。
   
   | 配置项 | 参数 | 说明 | 示例值 |
   | --- | --- | --- | --- |
   | 网络配置 | 可用区ID | 服务所在的可用区。 | 可用区 B |
   | 专有网络网段 | 服务所在的网络网段。 | 192.168.0.0/16 |
   | 交换机子网网段 | 服务所在的子网网段。 | 192.168.0.0/24 |
   | RDS配置 | 实例规格 | 云数据库RDS实例的规格。 | mysql.n2.medium.1 |
   | RDS数据库账号 | RDS实例的数据库账号和密码。 | |
   | RDS数据库密码 |
   | 数据库名称 | 创建的数据库名称。 | |
3. 在资源配置预览页面，确认模板参数以及费用之后，单击**创建**。
4. 当**资源栈信息**页面的**状态**显示为**创建成功**时表示魔笔应用创建完成。
### **网站编辑**


#### **编辑网站信息**

在应用创建完成后，您可以查看和编辑网站应用的全部模块。本文以新闻数据为例，详细介绍如何执行编辑操作。

1. 登录[魔笔控制台](https://mobinext.console.aliyun.com/173017070584941/?spm=5176.26976164.J_5682905290.2.5e2a789cnwl9my)，单击创建完成的应用，进入网站编辑页面。
   
   **说明** 
   
   如果您不想对示例数据进行变更，您也可以直接进行网站发布操作。
2. 选择左侧**代码**，单击**init\_data**文件，将**触发方式**变更为**手动触发**。
   
   ![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/5835983371/p880961.png)
3. 单击界面左上方**首页**。在下拉列表中，选择**后台数据\_新闻数据**，进入后台管理页面。
   
   ![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6835983371/p877055.png)
4. 在后台管理页面。
   
   * 您可以单击**删除**，清除模板提供的新闻数据，以便添加您想要展示的新闻数据。
   * 您也可以单击**新增**按钮，直接为网站添加数据。填写说明请参见下表。
   
   ![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6835983371/p881146.png)
   
   | **名称** | **填写说明** | **示例值** |
   | --- | --- | --- |
   | 标题 | 填写展示的新闻标题。 | 阿里云官网 |
   | 地址 | 填写以http/https开头的完整地址链接。 | https://www.aliyun.com/ |
   | 类型 | 选择新闻所属的行业类型。 | 行业 |
   | 发布时间 | 选择新闻的发布日期。 | 2024-12-01 |
5. 完成后，单击**提交**，即可完成新增数据。
6. 变更完成后，单击界面左上方**后台管理\_新闻数据** > **首页**返回网站首页，查看新增数据在网页上的展示情况。
   
   **说明** 
   
   您也可以单击**H5首页**，查看当前页面在移动端的展示情况。
   
   ![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6835983371/p877526.png)
#### **新组件添加（可选）**

您可以通过可视化拖拉拽的方式对魔笔各个组件进行添加和移动。本文以新建数据图表为例，为您介绍新组件的添加方式。

**说明** 

您也可以查阅魔笔文档，获取更多页面组件的使用方式，请参见：[页面组件](https://help.aliyun.com/document_detail/2834779.html#DAS)。

1. 单击左侧添加组件按钮，向下滑动找到折线图组件，拖动至工作区。
   
   ![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/5835983371/p877727.png)
2. 创建新的数据表。
   
   **说明** 
   
   若您只是想进行简单体验，可以在右侧**内容** > **数据源**中，直接对数据进行修改。
   
   1. 登录[云数据库RDS控制台](https://rdsnext.console.aliyun.com/)。
   2. 在左侧导航栏，选择**实例列表**。单击目标实例，进入实例管理页面。
   3. 在实例管理页面的左侧导航栏，选择**数据库管理**。
   4. 单击**登录数据库**，使用之前创建的账号和密码登录DMS系统。
   5. 在DMS中，选择相应的数据库，执行SQL命令创建表。示例创建表命令：
      
      ```
      CREATE TABLE home_ent (
          id INT AUTO_INCREMENT PRIMARY KEY,
          e_time VARCHAR(255),
          e_value VARCHAR(255),
          e_group VARCHAR(255)
      );
      ```
   6. 插入数据。示例命令：
      
      ```
      INSERT INTO home_ent (e_time, e_value, e_group) VALUES 
      ('2023', '1500000', '第一季度'),
      ('2023', '1650000', '第二季度'),
      ('2023', '1450000', '第三季度'),
      ('2023', '1550000', '第四季度'),
      ('2024', '1650000', '第一季度'),
      ('2024', '1500000', '第二季度'),
      ('2024', '1700000', '第三季度'),
      ('2024', '1600000', '第四季度');
      ```
   7. 回到[魔笔控制台](https://mobinext.console.aliyun.com/173017070584941/?spm=5176.26976164.J_5682905290.2.5e2a789cnwl9my)，进入应用界面。按图示顺序新建**集成操作**。
      
      ![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6835983371/p877747.png)
   8. 选中折线图组件，清空右侧**内容** > **数据源**中的原始数据。按照下图所示进行填写。
      
      ![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6835983371/p877761.png)
      
      **说明** 
      * **action5**：这里填写您新建的**集成操作**的文件名。
      * **横轴属性**、**纵轴属性**和**分组属性**：根据您实际的表字段进行填写即可。
   9. 选中新创建的**集成操作**，单击**集成资源**，选中集成的数据库。在下方**SQL语句**中填写代码，遍历新创建的数据表。
      
      ```
      SELECT * FROM home_ent;
      ```
      
      ![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6835983371/p877776.png)
   10. 单击**运行**，将数据加载至界面。
#### **网站发布**

在网站发布之前，您需要先对网站应用进行配置，确保使用阿里云账号进行登录后，再进行网站发布操作。

1. 在页面左下角选择**设置** > **登录配置**，确认**默认身份源**是**阿里云账号登录**，关闭**允许匿名访问**。
   
   **说明** 
   
   如果您需要将网站发布至**开发环境**，请关闭**允许匿名访问**。直接使用阿里云账号进行登录。
   
   如果您需要将网站发布至**生产环境**，则无需进行此设置，直接进入**发布上线**流程即可。
   
   ![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/1735605371/p881625.png)
2. 配置完成后，单击页面右上角**发布**按钮。
3. 选择**开发环境**，添加**描述**后，单击**确定**按钮。
4. 等待弹窗提示成功发布即可。
### **发布上线（可选）**

**说明** 

如果您仅想体验方案，无需申请域名和备案，可以跳过此步骤。

如果您想将网站发布至公网。需要完成以下操作：

* 需要使用独立域名，且域名必须经过 ICP 备案。
* 域名按照要求添加解析记录。

#### **域名申请和备案**

1. 创建域名信息模板并实名认证。
   
   1. 登录[阿里云域名控制台](https://dc.console.aliyun.com)。
   2. 在左侧导航栏单击**信息模板**，在**信息模板**页面单击**创建新信息模板**。
      
      ![1](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/3124796761/p571548.png)
   3. 根据界面提示，完成域名持有者信息填写，单击**提交**。
      
      展开查看填写说明。
      
      | **参数** | **个人** | **企业/组织** |
      | --- | --- | --- |
      | 域名持有者类型 | 选择**个人**。 | 选择**企业/组织**。 |
      | 信息填写方式 | 选择是否自动关联您的阿里云账号信息。 **说明**  如果您使用子账号登录域名控制台，则页面中没有此参数，您需手动填写域名持有者信息。 | |
      | 域名联系人（中文） | 无 | 填写域名联系人名称，通常是公司的技术人员作为域名联系人。 |
      | 所属区域 | 选择真实有效的通讯地址。 | 选择与营业执照上一致的区域。 **说明**  如果无法选择省市信息，建议您更换浏览器或更换网络环境。 |
      | 通讯地址（中文） | 填写真实有效的通讯地址。 | 填写与营业执照上一致的通讯地址。 |
      | 邮编 | 填写通讯地址所在地的邮政编码。 | 填写企业所在地的邮政编码。 |
      | 电子邮箱 | 填写域名联系人的电子邮箱，填写完成后请单击输入框下方的**点击进行****邮箱验证**，进行验证。 **说明**  * 建议不要使用test@test.club等新顶级域名后缀邮箱，避免域名订单长时间处于处理中状态，错失域名抢注等机会。 | |
      
      实名认证上传材料填写样例请参见如下：
      
      * [填写样例（个人）](https://help.aliyun.com/document_detail/108547.html#concept-f1l-skf-xgb)
      * [填写样例（组织）](https://help.aliyun.com/document_detail/108214.html#concept-gxx-hf3-wgb)
   4. 在[阿里云域名控制台](https://dc.console.aliyun.com)的左侧导航栏的**信息模板**中找到待查看的信息模板，查看**实名认证状态**。
      
      **说明** 
      
      域名实名认证资料的审核通常在1个工作日内可以完成，部分可能需要3~5个工作日，请您耐心等待审核结果。
2. 购买域名
   
   1. 查询域名。
      
      1. 登录[阿里云域名注册](https://wanwang.aliyun.com/)。
      2. 在阿里云域名注册页面的搜索框中，搜索您想要注册的域名以及域名后缀，单击**查询域名**。
         
         ![1](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/4395653271/p686823.jpg)
   2. 加入域名清单。
      
      1. 对于查询结果为**未注册**的域名，单击**加入清单**。
         
         ![加入清单](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/3906353271/p410819.jpg)
      2. 在**域名清单**中确认已添加的域名，单击**立即购买**。
   3. 确认订单信息。
      
      1. 在**确认订单**页面，选择域名的购买年限和域名所有者类型。
         
         ![确认订单](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/4395653271/p410805.jpg)
         
         **说明** 
         
         若您注册的是“.gov.cn”后缀域名，域名持有者类型只能为**企业**。
      2. 选择已完成实名认证的域名持有者信息模板。
   4. 选择支付方式后，单击**立即支付**。
      
      完成支付后，域名注册订单会短暂的显示为**处理中**状态，待订单状态变为**成功**，域名即注册成功。
      
      * 域名注册过程中的常见问题，请参见[域名注册FAQ](https://help.aliyun.com/document_detail/57976.html#concept-k3f-c2d-b2b)。
      * 如果域名注册失败，请参见[域名注册失败原因](https://help.aliyun.com/document_detail/84870.html)进行排查处理。
3. ICP备案前准备
   
   1. **（可选）前置审批。**
      
      新闻类、出版类、药品和医疗器械类、文化类、广播电影电视节目类、教育类、医疗保健类、网络预约车、电子公告类等行业的互联网信息服务，需联系当地机关办理对应的前置审批手续。各类行业对应的办理机关及手续类型请参见[前置审批](https://help.aliyun.com/document_detail/113602.html#concept-lc5-m1z-3hb)。
   2. **管局规则。**
      
      了解ICP备案所在地域的管局规则，根据管局要求准备ICP备案的材料。详细信息请在[各地区管局备案规则](https://help.aliyun.com/document_detail/50270.html#undefined)中单击对应省份查看。
4. 提交ICP备案
   
   1. **填写信息进行校验。**
      
      在[阿里云ICP代备案管理系统](https://beian.aliyun.com/order/index.htm)，根据界面提示，按要求填写主办单位信息和网站/App信息等，系统将根据您所填信息，自动校验是否可以进行ICP备案。
   2. **阿里云初审。**
      
      提交ICP备案初审订单后，订单状态为**阿里云审核中**，阿里云将会在**1个工作日**左右进行审核，具体以实际审核时间为准。
      
      ![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/8957855171/p783331.png)
   3. **（可选）邮寄资料。**
      
      **说明** 
      
      阿里云初审后如果需要您邮寄资料，审核人员会通知您。如果您在初审时未收到需要邮寄资料的相关通知，则无需邮寄资料，ICP备案流程将进入下一个阶段。
   4. **工信部短信核验。**
      
      当需要验证的手机号收到工信部发出的验证码短信后，您需在收到核验短信的24小时内，访问[工信部备案管理系统](https://beian.miit.gov.cn/)进行短信核验。
      
      **说明** 
      
      建议通过手机移动数据（关闭WiFi连接）进行短信核验。
      
      1. 进入[工信部备案管理系统](https://beian.miit.gov.cn)，单击**短信核验**。
      2. 填写短信核验信息。
         
         在**短信核验**页签下，根据下方要求填写短信验证码、手机号码、证件号码后6位等信息，填写完成后单击**提交**，系统将进行自动审核。
         
         ![短信核验项](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7110016061/p184448.png)
      3. 确认短信核验结果。
         
         * 如系统提示**您的短信核验已全部完成，该请求将提交管局审核**，说明您的ICP备案订单已完成短信核验操作。
           
           **说明** 
           
           短信核验成功后，您的ICP备案订单将直接进入管局审核，工信部不会下发短信通知。短信核验结果会在24小时内同步至阿里云，您可前往[阿里云ICP代备案管理系统](https://beian.aliyun.com/order/index.htm)在**我的备案**中查看。
           
           ![核验完成](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/1289906061/p184442.png)
         * 如系统提示**您的短信核验完成，请等待其他核验人进行短信核验**，说明您的ICP备案订单中还有其他需要验证的手机号码，请联系其他负责人及时完成核验。
           
           ![还有一个人没有核验](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/1289906061/p184443.png)
   5. **管局审核。**
      
      订提交管局后订单为**待提交管局**状态，阿里云审核专员将会在**1个工作日**左右将您的订单提交至管局审核，具体以实际提交时间为准
      
      各省管局审核时间不同，实际审核时长会根据ICP备案场景有所不同，一般为1~20个工作日，具体以实际审核时间为准。管局审核通过后表示您的ICP备案即已完成，审核结果会发送至您的手机和邮箱。
5. ICP备案后操作
   
   1. **添加ICP备案号及版本所有 。**
      
      ICP备案成功后，您需要在互联网信息服务底部添加备案号和跳转至工信部的链接，以便访问者查询确认ICP备案信息。部分省份管局要求，例如江苏省，需要在互联网信息服务下方添加版权所有。详情请参见[添加ICP备案号和版权处理](https://help.aliyun.com/document_detail/146190.html#concept-2356706)。
   2. **（可选）ICP许可证。** 
      
      如果您的互联网信息服务属于经营性网站或App（通过互联网向上网用户有偿提供信息或者网页制作等服务活动），则需在ICP备案后申请经营性ICP许可证。详情请参见[经营性备案](https://help.aliyun.com/document_detail/36978.html#concept-rhw-fsl-zdb)。
      
      **说明** 
      
      弹性Web托管服务器不支持经营性备案。
   3. **公安联网备案。**
      
      依据 **《计算机信息网络国际联网安全保护管理办法》**相关规定，各互联网信息服务在工信部备案成功后，需在开通之日起30日内登录[全国互联网安全管理服务平台](http://www.beian.gov.cn/portal/index?spm=a2c4g.11186623.2.1.SRC9LP)提交公安联网备案申请。详情请参见[公安联网备案及注销](https://help.aliyun.com/document_detail/43898.html#concept-dw1-2sl-zdb)。
#### **网站发布**

1. 单击页面右上角**发布**按钮。
2. 选中**生产环境**，单击**下一步**。
3. 单击**前往域名设置**。
4. 单击**添加域名**，在弹出的对话框中填写您已完成实名认证并且备案的域名后，单击**下一步**。
5. **防火墙类型**选择**系统内置**，根据界面提示，为域名添加相应的解析记录。
   
   **说明** 
   
   请在新页面进入云解析DNS控制台，并且不要关闭本页面。
   
   ![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6835983371/p879814.png)
   
   1. 登录[云解析DNS控制台](https://dns.console.aliyun.com/#/dns/domainList)。
   2. 在左侧菜单栏点击**公网DNS解析**>**权威域名解析**，在**权威域名解析**页面的域名列表中找到目标域名，在右侧**操作**列中点击**解析设置**。
   3. 在域名**解析设置**页签中点击**添加记录**，填写域名解析信息，然后单击**确认**。
      
      1. 添加**TXT**记录。
         
         | 配置项 | 说明 | 示例值 |
         | --- | --- | --- |
         | **记录类型** | 选择域名指向的类型。此处选择**TXT**。 | **TXT** |
         | **主机记录** | 填写弹窗中给出的主机记录。 | mobidnscheck.top |
         | **记录值** | 填写弹窗中给出的记录值。 | e0861\*\*\*\*3694 |
         | **TTL** | 域名的更新周期，保留默认值。 | 10分钟 |
      2. 添加**CNAME**记录。
         
         | 配置项 | 说明 | 示例值 |
         | --- | --- | --- |
         | **记录类型** | 选择域名指向的类型。此处选择**CNAME**。 | **CNAME** |
         | **主机记录** | 填写弹窗中给出的主机记录。 | **@** |
         | **记录值** | 填写弹窗中给出的记录值。 | cn-beijing.mobiapp.cloud |
         | **TTL** | 域名的更新周期，保留默认值。 | 10分钟 |
6. 解析记录添加完成，单击**开始验证**，成功后单击**下一步**。
7. 选中**生产环境**后单击**完成**，完成网站的公网发布。
8. 资源集成配置。
   
   1. 登录[魔笔控制台](https://mobinext.console.aliyun.com/173017070584941/?spm=5176.26976164.J_5682905290.2.5e2a789cnwl9my)。
   2. 在**资源** > **集成**下，选择当前应用使用的**集成**，单击**编辑**。
      
      ![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/5835983371/p882665.png)
   3. 进入编辑页面后，选择**生产环境**页签，按照实际使用的数据库完成配置后，单击**确定**即可。
### **完成及清理**

4

#### 方案验证

1. 登录[魔笔控制台](https://mobinext.console.aliyun.com/173017070584941/?spm=5176.26976164.J_5682905290.2.5e2a789cnwl9my)，单击**应用**，进入应用列表页面。
2. 选择您构建完成的应用，单击**开发环境**。
   
   **说明** 
   
   如果您选择了发布上线，您可以单击**生产环境**，访问构建完成的网站页面。
   
   ![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/5835983371/p881113.png)
3. 在弹出的对话框中，单击**应用地址**后的链接，即可访问构建完成的网站页面。
4. 网站模板页面如下。
   
   **说明** 
   
   如果您没有进行添加自定义组件操作，则页面中不会出现数据图表模块。
   
   ![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/5835983371/p880906.png)
#### 清理资源

您可以使用ROS一键删除创建的云资源，避免继续产生费用。

1. 登录[ROS控制台](https://ros.console.aliyun.com/overview)。
2. 在左侧导航栏，选择**资源栈**。
3. 在**资源栈**页面的顶部选择部署的资源栈所在地域，找到资源栈，然后在其右侧**操作**列，单击**删除**。
4. 在**删除资源栈**对话框，选择**删除方式**为**释放资源**，然后单击**确定**，根据提示完成资源释放。
